
# 智能板书自动保存系统 v6.1

**智能板书自动保存系统**是一款为教师、演讲者和在线教育工作者设计的Windows桌面工具。它能**按固定间隔自动截图**，对指定的程序窗口或整个屏幕进行**定时截图**，自动识别并过滤重复截图，并按日期组织保存为高清图片文件，实现教学与会议板书内容的自动化归档。

---

## 📑 目录
1.  [核心特性](#-核心特性)
2.  [功能亮点](#-功能亮点)
3.  [安装与使用](#-安装与使用)
4.  [项目结构](#-项目结构)
5.  [更新日志](#-更新日志)
6.  [技术架构](#-技术架构)
7.  [许可说明](#-许可说明)

---

## ✨ 核心特性

| 功能模块 | 描述 |
| :--- | :--- |
| **固定间隔监控** | 按设定时间间隔自动截图，无需用户活动检测，保证稳定可靠。 |
| **自动去重** | 使用MD5哈希算法自动识别并过滤重复截图，节省存储空间。 |
| **精准截图** | 支持截取整个显示器或仅针对指定的前台程序窗口（如 `notepad.exe`, `chrome.exe`）。 |
| **智能缓冲** | 内置内存缓冲区管理，自动过滤重复内容，缓冲区满时自动触发保存。 |
| **自动归档** | 截图文件按`年-月-日_星期`格式自动分文件夹保存，并采用`年-月-日-时-分-秒`规范命名。 |
| **计划任务** | 支持设定每日多个固定时间点（如09:00, 12:00）自动保存缓冲区内容。 |
| **无缝体验** | 系统托盘运行，支持开机自启动、静默启动、窗口最小化到托盘，不占用任务栏空间。 |
| **进程管理** | 可实时检测并提示指定进程是否存在，并保存进程名历史记录，方便快速调用。 |

---

## 🚀 功能亮点

### 🔄 智能去重技术
*   **自动去重**：使用MD5哈希算法自动识别重复截图，避免存储相同内容。
*   **实时过滤**：在缓冲区阶段即时过滤重复截图，减少不必要的磁盘写入。
*   **资源优化**：减少存储空间占用，提高截图管理效率。

### 🎯 智能进程监控
*   **进程检测**：在设置框内输入进程名（如 `ppt.exe`），系统会实时检查该进程是否存在，并**以醒目的颜色（绿色/红色）给予直观反馈**。
*   **历史记录**：自动保存并使用过的进程名，形成下拉列表，方便下次快速选择。
*   **状态显示**：状态栏会清晰显示当前监控目标（如"监控正在对进程 `ppt.exe` 生效"或"整个显示器"）。

### 💾 优化的存储逻辑
*   **按日期与星期归档**：所有截图自动保存到以 `YYYY-MM-DD_星期X` 命名的文件夹中，管理一目了然。
*   **规范文件命名**：每张截图均以 `YYYY-MM-DD-HH-MM-SS.png` 格式命名，便于排序和查找。
*   **缓冲区控制**：严格遵循"**未启动监控，不截图**"的原则。仅在用户点击"开始监控"后，系统才会将截图数据写入内存缓冲区，杜绝资源浪费。

### ⚙️ 便捷的系统集成
*   **开机自启监控**：启用"开机自启动"选项后，系统将在下次开机时自动启动并**立即开始监控**，无需手动操作。
*   **静默托盘运行**：配合"静默启动"选项，可实现开机后直接隐藏到系统托盘后台运行。
*   **无感退出**：从系统托盘右键菜单选择"退出"时，**直接关闭程序，无需二次确认**，操作更流畅。

### 📊 直观的状态管理
*   **实时状态面板**：主界面集中展示监控状态、截图模式、截图计数和缓冲区使用率。
*   **运行日志**：软件内集成的日志页面，记录了所有操作、截图事件和错误信息，支持清空和保存。
*   **动态可视化**：缓冲区进度条随使用量变化颜色，体积估计功能可预测缓冲区占用的磁盘空间。

---

## 📥 安装与使用

### 方法一：使用已编译版本 (推荐)
1.  从项目的 `Releases` 页面或 `dist/` 目录下载最新的 `SmartBoardMonitor.exe`。
2.  双击运行即可，程序首次启动会自动在相同目录下创建 `config.ini` 配置文件。
3.  右键系统托盘图标，选择"显示窗口"进行配置。

### 方法二：从源代码运行
> **系统要求**：Windows 7/8/10/11， Python 3.7+

```bash
# 1. 克隆或下载本项目源代码
git clone [您的项目仓库地址]
cd SmartBoardMonitor

# 2. 安装Python依赖库
pip install -r requirements.txt

# 3. 运行主程序
python main.py

### 方法三：从源代码编译为独立EXE
项目提供了完整的编译脚本。
```bash
# 在项目根目录下执行编译脚本
python build_exe.py
# 编译完成后，可在 `dist/` 文件夹中找到 `SmartBoardMonitor.exe`
```

---

## 📁 项目结构
```
SmartBoardMonitor_v6/
├── modules/                     # 核心功能模块
│   ├── __init__.py
│   ├── gui.py                  # 主界面 (PyQt5)
│   ├── buffer.py              # 缓冲区与文件保存管理（含去重功能）
│   ├── screenshot.py          # 屏幕与窗口截图
│   ├── detector.py            # 输入活动检测 (键盘、鼠标、Ink)（兼容保留）
│   ├── config.py              # 配置管理与开机自启
│   ├── tray.py                # 系统托盘管理
│   └── logger.py              # 日志系统
├── resources/                  # 程序资源文件
├── screenshots/                # 截图自动保存目录（运行后生成）
├── main.py                     # 程序主入口（固定间隔截图模式）
├── build_exe.py                # PyInstaller编译脚本
├── requirements.txt            # Python依赖列表
├── config.ini                  # 用户配置文件（运行后生成）
├── icon.ico                    # 程序图标
└── README.md                   # 本文档
```

---

## 📜 更新日志

### v6.1 (2025-01-15) - 当前版本
*   **优化**：**截图模式改进**
    *   移除前台活动检测功能，改为固定间隔截图模式。
    *   简化监控逻辑，提高系统稳定性。
*   **新增**：**智能去重功能**
    *   使用MD5哈希算法自动识别并过滤重复截图。
    *   在缓冲区阶段实现实时去重，减少存储空间占用。
    *   提高截图管理效率，避免重复内容保存。
*   **优化**：更新用户界面，将"活动状态"显示改为"固定间隔模式"显示。

### v6.0 (2025-12-22)
*   **新增**：**进程监控高级功能**
    *   实时进程存在性检测与视觉化反馈（红/绿色提示）。
    *   进程名历史记录保存与快速选择。
    *   状态栏动态显示当前监控目标。
*   **新增**：**智能存储增强**
    *   截图文件夹命名增加**星期信息**（`2023-12-22_周五`）。
    *   强化"**开始监控前不写入数据**"的逻辑控制。
*   **新增**：**自动化与体验优化**
    *   启用"开机自启动"后，程序将**自动开始监控**。
    *   系统托盘右键菜单"退出"**取消确认对话框**，操作更直接。
*   **优化**：重构监控线程逻辑，解决停止监控时的界面卡顿问题。
*   **优化**：GUI布局，增加"日志"标签页和文件体积预估显示。

### v5.x 及更早
*   基础截图、缓冲区管理、定时保存、系统托盘、图形化配置界面等核心功能的实现。

---

## 🛠 技术架构
本系统采用前后端分离的设计思想，核心模块间通过信号机制松耦合。
```
[用户界面层 (GUI/Tray)]
         ↑↓ PyQt5信号
[业务逻辑层 (Main App)]
         ↑↓ 线程/队列
[数据服务层 (Buffer/Config/Logger)]
         ↑↓ 哈希去重算法
[系统接口层 (Screenshot/Detector)]
```

### 关键技术
- **截图去重技术**：采用MD5哈希算法计算图片特征值，实时过滤重复内容
- **固定间隔定时器**：使用QTimer实现精准的时间间隔控制
- **内存缓冲区管理**：使用队列数据结构高效管理截图数据
- **进程监控**：通过psutil库实时检测指定进程状态

---

## 📄 许可说明
本项目基于 MIT 协议开源，仅供个人学习与交流使用。请注意，请勿将其用于任何可能侵犯他人隐私或违反法律法规的用途。

---

**让每一次讲解与创作，都被智能珍藏。**
```
